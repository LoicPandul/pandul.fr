---
title: "MaÃ®triser les bases de lâ€™analyse de chaÃ®ne sur Bitcoin."
date: 2023-09-29
---

Une des fonctions de la monnaie est de rÃ©soudre le problÃ¨me de la double coÃ¯ncidence des besoins. Dans un systÃ¨me Ã©tabli sur le troc, la rÃ©alisation d'un Ã©change nÃ©cessite non seulement de trouver un individu cÃ©dant un bien correspondant Ã  mon besoin, mais aussi de lui procurer un bien de valeur Ã©quivalente qui satisfait son propre besoin. Trouver cet Ã©quilibre s'avÃ¨re complexe. C'est pourquoi nous recourons Ã  la monnaie qui permet de dÃ©placer la valeur Ã  la fois dans l'espace et dans le temps.

Pour que la monnaie rÃ©solve ce problÃ¨me, il est essentiel que la partie qui fournit un bien ou un service soit convaincue de sa capacitÃ© Ã  dÃ©penser cette somme ultÃ©rieurement. Ainsi, tout individu rationnel souhaitant accepter une piÃ¨ce de monnaie, qu'elle soit numÃ©rique ou physique, s'assurera qu'elle remplit deux critÃ¨res fondamentaux :

Si lâ€™on utilise une monnaie physique, câ€™est la premiÃ¨re caractÃ©ristique qui est la plus complexe Ã  faire valoir. Ã€ diffÃ©rentes pÃ©riodes de lâ€™histoire, lâ€™intÃ©gritÃ© des piÃ¨ces de mÃ©taux a souvent Ã©tÃ© affectÃ©e par des pratiques comme le rognage ou le perÃ§age. Par exemple, durant la Rome antique, il Ã©tait courant que les citoyens grattent les bords des piÃ¨ces dâ€™or pour en recueillir un peu de mÃ©tal prÃ©cieux, tout en les conservant pour des transactions futures. Câ€™est notamment pour cette raison que lâ€™on a plus tard frappÃ© des cannelures sur la tranche des piÃ¨ces. Lâ€™authenticitÃ© est Ã©galement une caractÃ©ristique difficile Ã  vÃ©rifier sur un support monÃ©taire physique. De nos jours, les techniques pour lutter contre le faux monnayage sont de plus en plus complexes, obligeant les commerÃ§ants Ã  investir dans des systÃ¨mes de vÃ©rification coÃ»teux.

En revanche, en raison de leur nature, la double dÃ©pense n'est pas un problÃ¨me pour les monnaies physiques. Si je vous cÃ¨de un billet de 10 â‚¬, il quitte irrÃ©vocablement ma possession pour entrer dans la vÃ´tre, excluant par lÃ  mÃªme toute possibilitÃ© de dÃ©pense multiple des unitÃ©s monÃ©taires quâ€™il incarne.

Pour la monnaie numÃ©rique, la difficultÃ© est diffÃ©rente. Sâ€™assurer de lâ€™authenticitÃ© et de lâ€™intÃ©gritÃ© dâ€™une piÃ¨ce est souvent plus simple, mais sâ€™assurer de l'absence de double dÃ©pense est plus complexe. Tout bien numÃ©rique est en essence de l'information. Contrairement aux biens physiques, l'information ne se divise pas lors des Ã©changes, mais se propage en se multipliant. Par exemple, si je vous transmets un document par courrier Ã©lectronique, ce dernier se retrouve alors dupliquÃ©. De votre cÃ´tÃ©, vous ne pouvez pas vÃ©rifier avec certitude que j'ai effacÃ© le document original.

Le seul moyen dâ€™Ã©viter cette duplication dâ€™un bien numÃ©rique est dâ€™Ãªtre au courant de lâ€™intÃ©gralitÃ© des Ã©changes sur le systÃ¨me. De cette maniÃ¨re, on peut savoir qui possÃ¨de quoi et actualiser les comptes de chacun en fonction des transactions effectuÃ©es. Câ€™est ce qui se fait, par exemple, pour la monnaie scripturale. Lorsque lâ€™on paie 10 â‚¬ Ã  un commerÃ§ant par carte bancaire, la banque constate cet Ã©change et actualise le livre des comptes.

Sur Bitcoin, la prÃ©vention de la double dÃ©pense se fait de la mÃªme maniÃ¨re. On va chercher Ã  confirmer l'absence d'une transaction ayant dÃ©jÃ  dÃ©pensÃ© les piÃ¨ces en question. Si ces derniÃ¨res n'ont jamais Ã©tÃ© utilisÃ©es, alors nous pouvons Ãªtre assurÃ©s qu'aucune double dÃ©pense n'aura lieu. Câ€™est la fameuse phrase de Satoshi Nakamoto dans le White Paper (livre blanc) :

> Â« *Le seul moyen pour confirmer lâ€™absence dâ€™une transaction est dâ€™Ãªtre au courant de toutes les transactions.* Â»

Contrairement au modÃ¨le bancaire, on ne souhaite pas avoir Ã  faire confiance Ã  une entitÃ© centrale sur Bitcoin. Il faut alors que tous les utilisateurs soient en capacitÃ© de confirmer cette absence de double dÃ©pense, sans pour autant reposer sur un tiers. Ainsi, il faut que chacun soit au courant de toutes les transactions Bitcoin.

C'est prÃ©cisÃ©ment cette diffusion publique de lâ€™information qui complique la protection de la vie privÃ©e sur Bitcoin. Dans le systÃ¨me bancaire traditionnel, en thÃ©orie, seule l'institution financiÃ¨re a connaissance des transactions effectuÃ©es. En revanche, sur Bitcoin, l'ensemble des utilisateurs est informÃ© de toutes les transactions, via leurs nÅ“uds respectifs.

Ã€ cause de cette contrainte de diffusion, le modÃ¨le de confidentialitÃ© de Bitcoin diffÃ¨re de celui du systÃ¨me bancaire. Dans ce dernier, les transactions sont associÃ©es Ã  lâ€™identitÃ© de lâ€™utilisateur, mais le flux dâ€™information est coupÃ© entre le tiers de confiance et le public. Autrement dit, votre banquier sait que vous achetez votre baguette tous les matins au boulanger du coin, mais votre voisin nâ€™a pas connaissance de toutes ces transactions. Dans le cas de Bitcoin, puisque le flux dâ€™information ne peut pas Ãªtre cassÃ© entre les transactions et le domaine public, le modÃ¨le de confidentialitÃ© repose sur la sÃ©paration entre lâ€™identitÃ© de lâ€™utilisateur et les transactions en elles-mÃªmes.

SchÃ©ma inspirÃ© de celui de Satoshi Nakamoto dans le White Paper (livre blanc) : *Bitcoin: A Peer-to-Peer Electronic Cash System*, partie 10 Â« Privacy Â».

Puisque les transactions Bitcoin sont rendues publiques, il devient possible d'Ã©tablir des liens entre elles pour en dÃ©duire des renseignements sur les parties impliquÃ©es. Cette activitÃ© constitue mÃªme une spÃ©cialitÃ© en soi, communÃ©ment appelÃ©e Â« analyse de chaÃ®ne Â». Dans cet article, je vous invite Ã  explorer les fondamentaux de l'analyse de chaÃ®ne afin de comprendre comment vos bitcoins sont tracÃ©s.

La majoritÃ© des entreprises spÃ©cialisÃ©es dans l'analyse de chaÃ®ne opÃ¨rent comme des boÃ®tes noires, ne divulguant pas leurs mÃ©thodologies. Il est donc difficile d'obtenir des informations sur cette pratique. Pour la rÃ©daction de cet article, je me suis principalement appuyÃ© sur les rares ressources ouvertes disponibles :

Je tiens Ã  remercier leurs auteurs, dÃ©veloppeurs et producteurs. Sans leurs diffÃ©rents contenus et logiciels, cet article nâ€™existerait pas. Je remercie Ã©galement les relecteurs qui ont mÃ©ticuleusement corrigÃ© ce texte et m'ont gratifiÃ© de leurs conseils dâ€™experts :

*ğŸ“Œ Pour information, jâ€™ai ajoutÃ© un miniglossaire technique Ã  la fin de lâ€™article pour dÃ©finir certains termes. Si vous voyez un mot que vous ne comprenez pas avec une Ã©toile, sa dÃ©finition se trouve en bas de la page.*

### SOMMAIRE :

## **Câ€™est quoi lâ€™analyse de chaÃ®n****e ?**

Lâ€™analyse de chaÃ®ne est une pratique qui regroupe toutes les mÃ©thodes permettant de tracer les flux de bitcoins sur la blockchain. De faÃ§on gÃ©nÃ©rale, lâ€™analyse de chaÃ®ne sâ€™appuie sur lâ€™observation de caractÃ©ristiques sur des Ã©chantillons de transactions antÃ©rieures. Elle consiste ensuite Ã  repÃ©rer ces mÃªmes caractÃ©ristiques sur une transaction que lâ€™on souhaite analyser, et Ã  en dÃ©duire des interprÃ©tations vraisemblables. Cette mÃ©thode de rÃ©solution de problÃ¨me Ã  partir dâ€™une approche pratique, pour trouver une solution suffisamment bonne, câ€™est ce que lâ€™on appelle une heuristique.

Pour vulgariser, lâ€™analyse de chaÃ®ne se fait en deux grandes Ã©tapes :

1. Le repÃ©rage de **caractÃ©ristiques connues** ;
2. La dÃ©duction dâ€™**hypothÃ¨ses**.

Un des objectifs de lâ€™analyse de chaÃ®ne consiste Ã  regrouper diverses activitÃ©s sur Bitcoin en vue de dÃ©terminer l'unicitÃ© de l'utilisateur les ayant effectuÃ©es. Par la suite, il sera possible de tenter de rattacher ce faisceau d'activitÃ©s Ã  une identitÃ© rÃ©elle.

Rappelez-vous de mon introduction. Je vous ai expliquÃ© pourquoi le modÃ¨le de confidentialitÃ© de Bitcoin reposait originellement sur la sÃ©paration entre lâ€™identitÃ© de lâ€™utilisateur et ses transactions. Il serait donc tentant de penser que l'analyse de chaÃ®ne s'avÃ¨re inutile, puisque mÃªme si l'on parvient Ã  regrouper des activitÃ©s on-chain, on ne peut pas les associer Ã  une identitÃ© rÃ©elle. ThÃ©oriquement, cette affirmation est exacte. On emploie des paires de clÃ©s cryptographiques pour Ã©tablir des conditions sur les UTXO. Par essence, ces paires de clÃ©s ne divulguent aucune information sur lâ€™identitÃ© de leurs dÃ©tenteurs. Ainsi, mÃªme si l'on rÃ©ussit Ã  regrouper les activitÃ©s associÃ©es Ã  diffÃ©rentes paires de clÃ©s, cela ne nous renseigne en rien sur l'entitÃ© Ã  l'origine de ces activitÃ©s.

Cependant, la rÃ©alitÃ© pratique est bien plus complexe. Il existe une multitude de comportements qui risquent de lier une identitÃ© rÃ©elle Ã  une activitÃ© on-chain. En analyse, on appelle cela un point dâ€™entrÃ©e, et il en existe une multitude. Le plus courant, câ€™est Ã©videmment le KYC. Si vous retirez vos bitcoins dâ€™une plateforme rÃ©gulÃ©e vers une de vos adresses de rÃ©ception personnelles, alors certaines personnes sont en capacitÃ© de lier votre identitÃ© Ã  cette adresse. Plus largement, un point dâ€™entrÃ©e peut Ãªtre toute forme dâ€™interaction entre votre vie rÃ©elle et une transaction Bitcoin. Par exemple, si vous publiez une adresse de rÃ©ception sur vos rÃ©seaux sociaux, cela peut constituer un point dâ€™entrÃ©e pour une analyse. Si vous rÃ©alisez un paiement en bitcoins Ã  votre boulanger, ce dernier pourra associer votre face (qui fait partie de votre identitÃ©) Ã  une adresse Bitcoin.

Ces points d'entrÃ©e sont quasiment inÃ©vitables dans l'usage de Bitcoin. Bien que l'on puisse chercher Ã  en restreindre la portÃ©e, ils demeureront prÃ©sents. C'est pourquoi il est crucial de combiner les mÃ©thodes visant Ã  prÃ©server votre vie privÃ©e. Si maintenir une sÃ©paration acceptable entre votre identitÃ© rÃ©elle et vos transactions est une dÃ©marche louable, elle demeure insuffisante. En effet, si l'ensemble de vos activitÃ©s on-chain peut Ãªtre regroupÃ©, alors le moindre petit point d'entrÃ©e est susceptible de compromettre l'unique couche de confidentialitÃ© que vous aviez instaurÃ©e.

Ainsi, il faut Ã©galement pouvoir faire face Ã  lâ€™analyse de chaÃ®ne dans notre utilisation de Bitcoin. En procÃ©dant de la sorte, nous pouvons minimiser l'agrÃ©gation de nos activitÃ©s et limiter lâ€™impact dâ€™un point dâ€™entrÃ©e sur notre vie privÃ©e. Justement, pour mieux contrecarrer l'analyse de chaÃ®ne, quelle meilleure approche que de s'initier aux mÃ©thodes employÃ©es dans lâ€™analyse de chaÃ®ne ? Si vous souhaitez savoir comment amÃ©liorer votre confidentialitÃ© sur Bitcoin, vous devez comprendre ces mÃ©thodes. Cela vous permettra de mieux apprÃ©hender les techniques comme [le Coinjoin ou le Payjoin](https://www.pandul.fr/post/comprendre-et-utiliser-le-coinjoin-sur-bitcoin), et de rÃ©duire les erreurs que vous pourriez faire.

En Ã§a, nous pouvons faire une analogie avec la cryptographie et la cryptanalyse. Un bon cryptographe est avant tout un bon cryptanalyste. Pour imaginer un nouvel algorithme de chiffrement, il faut savoir quelles sont les attaques auxquelles il devra faire face, et Ã©galement Ã©tudier pourquoi les algorithmes prÃ©cÃ©dents ont Ã©tÃ© cassÃ©s. Le mÃªme principe s'applique Ã  la confidentialitÃ© sur Bitcoin. Comprendre les mÃ©thodes de l'analyse de chaÃ®ne est la clÃ© pour s'en prÃ©munir. Câ€™est pour cette raison que je vous propose cet article.

Il est primordial de comprendre que l'analyse de chaÃ®ne n'est pas une science exacte. Elle repose sur des heuristiques dÃ©rivÃ©es d'observations antÃ©rieures ou dâ€™interprÃ©tations logiques. Ces rÃ¨gles permettent d'obtenir des rÃ©sultats assez fiables, mais jamais d'une prÃ©cision absolue. En d'autres termes, l'analyse de chaÃ®ne implique toujours une dimension de probabilitÃ© dans les conclusions Ã©mises. On pourra estimer avec plus ou moins de certitude que deux adresses appartiennent Ã  une mÃªme entitÃ©, mais une certitude totale sera toujours hors de portÃ©e.

Tout lâ€™objectif de l'analyse de chaÃ®ne rÃ©side prÃ©cisÃ©ment dans l'agrÃ©gation de diverses heuristiques en vue de minimiser le risque d'erreur. Il s'agit en quelque sorte d'une accumulation de preuves qui nous permet de nous approcher davantage de la rÃ©alitÃ©.

Ces fameuses heuristiques peuvent Ãªtre regroupÃ©es en diffÃ©rentes catÃ©gories que nous allons dÃ©tailler ensemble :

* Les patterns de transaction (ou modÃ¨les de transaction) ;
* Les heuristiques internes Ã  la transaction ;
* Les heuristiques externes Ã  la transaction.

Notons que les deux premiÃ¨res heuristiques sur Bitcoin ont Ã©tÃ© formulÃ©es par Satoshi Nakamoto lui-mÃªme. Il les expose dans la partie 10 du White Paper (livre blanc). Comme nous le verrons plus loin, il est intÃ©ressant dâ€™observer que ces deux heuristiques conservent toujours une prÃ©Ã©minence dans lâ€™analyse de chaÃ®ne aujourdâ€™hui. Ce sont :

Ã‰tudions ensemble les diffÃ©rentes caractÃ©ristiques observables et les interprÃ©tations que lâ€™on peut en tirer pour rÃ©aliser une analyse.

## **Les patterns de transactions (ou modÃ¨les de transactions)**

Un pattern de transaction est simplement un modÃ¨le de transaction typique, que lâ€™on peut retrouver sur la blockchain, dont on connaÃ®t lâ€™interprÃ©tation vraisemblable. Lorsque lâ€™on Ã©tudie les patterns, on va sâ€™attarder sur une seule transaction que lâ€™on va analyser Ã  un niveau Ã©levÃ©. En dâ€™autres termes, on va uniquement regarder le nombre dâ€™entrÃ©es et le nombre de sorties, sans nous attarder sur ses dÃ©tails plus spÃ©cifiques ou son environnement. Ã€ partir du modÃ¨le observÃ©, nous pourrons interprÃ©ter la nature de la transaction. On va alors rechercher des **caractÃ©ristiques** sur sa structure et en dÃ©duire une **interprÃ©tation**.

### **Lâ€™envoi simple (ou le paiement simple)**

Ce modÃ¨le se caractÃ©rise par la consommation dâ€™un ou plusieurs UTXOs en entrÃ©e et la production de deux UTXOs en sortie.

Lâ€™interprÃ©tation de ce modÃ¨le est que nous sommes en prÃ©sence dâ€™une transaction dâ€™envoi ou de paiement. Lâ€™utilisateur a consommÃ© ses propres UTXOs en entrÃ©e pour satisfaire en sortie un UTXO de paiement et un UTXO de change (rendu de monnaie qui revient vers le mÃªme utilisateur). Nous savons donc que lâ€™utilisateur observÃ© nâ€™est vraisemblablement plus en possession dâ€™un des deux UTXOs en sortie (celui du paiement), mais quâ€™il est toujours en possession de lâ€™autre UTXO (celui de change).

Pour l'instant, il nous est impossible de prÃ©ciser quelle sortie reprÃ©sente quel UTXO, puisque ce n'est pas l'objectif de ce modÃ¨le. Nous y parviendrons en nous appuyant sur les heuristiques que nous Ã©tudierons dans la partie suivante. Ã€ ce stade, notre objectif se limite Ã  identifier la nature de la transaction en question, qui est, en l'occurrence, un envoi simple.

Par exemple, voici une transaction Bitcoin qui adopte le pattern de lâ€™envoi simple :

b6cc79f45fd2d7669ff94db5cb14c45f1f879ea0ba4c6e3d16ad53a18c34b769

### **Le balayage (Â« sweep Â» en anglais)**

Ce modÃ¨le se caractÃ©rise par la consommation dâ€™un seul UTXO en entrÃ©e et la production dâ€™un seul UTXO en sortie.

Lâ€™interprÃ©tation de ce modÃ¨le est que nous sommes en prÃ©sence dâ€™un auto-transfert. Lâ€™utilisateur sâ€™est transfÃ©rÃ© ses bitcoins Ã  lui-mÃªme, sur une autre adresse lui appartenant. En effet, puisquâ€™aucun change n'existe sur la transaction, il est trÃ¨s peu plausible que lâ€™on soit en prÃ©sence dâ€™un paiement. Nous savons alors que lâ€™utilisateur observÃ© est vraisemblablement encore en possession de cet UTXO.

Par exemple, voici une transaction Bitcoin qui adopte le pattern du balayage :

35f1072a0fda5ae106efb4fda871ab40e1f8023c6c47f396441ad4b995ea693d

Attention, ce type de pattern peut Ã©galement rÃ©vÃ©ler un auto-transfert sur le compte dâ€™un exchange (plateforme dâ€™Ã©change de cryptomonnaies). Ce seront lâ€™Ã©tude des adresses connues et le contexte de la transaction qui nous permettront de savoir si câ€™est un balayage vers un portefeuille en self-custody (conservation autonome) ou un retrait vers une plateforme.

### **La consolidation**

Ce modÃ¨le se caractÃ©rise par la consommation de plusieurs UTXOs en entrÃ©e et la production dâ€™un seul UTXO en sortie.

Lâ€™interprÃ©tation de ce modÃ¨le est que nous sommes en prÃ©sence dâ€™une consolidation. Câ€™est une pratique courante chez les utilisateurs de Bitcoin, visant Ã  fusionner plusieurs UTXOs en anticipation d'une Ã©ventuelle augmentation des frais de transaction. En effectuant cette opÃ©ration durant une pÃ©riode oÃ¹ les frais sont bas, il est possible de rÃ©aliser des Ã©conomies sur les frais futurs.

Nous pouvons en dÃ©duire que lâ€™utilisateur derriÃ¨re cette transaction Ã©tait vraisemblablement en possession de lâ€™intÃ©gralitÃ© des UTXOs en entrÃ©e et quâ€™il est toujours en possession de lâ€™UTXO en sortie. Câ€™est donc sÃ»rement un auto-transfert.

Tout comme le balayage, ce type de pattern peut Ã©galement rÃ©vÃ©ler un auto-transfert sur le compte dâ€™un exchange. Ce seront lâ€™Ã©tude des adresses connues et le contexte de la transaction qui nous permettront de savoir si câ€™est une consolidation vers un portefeuille en self-custody ou un retrait vers une plateforme.

Par exemple, voici une transaction Bitcoin qui adopte le pattern de la consolidation :

77c16914211e237a9bd51a7ce0b1a7368631caed515fe51b081d220590589e94

### **La dÃ©pense groupÃ©e**

Ce modÃ¨le se caractÃ©rise par la consommation de quelques UTXO en entrÃ©e (souvent un seul) et la production de nombreux UTXOs en sortie.

Lâ€™interprÃ©tation de ce modÃ¨le est que nous sommes en prÃ©sence dâ€™une dÃ©pense groupÃ©e. Câ€™est une pratique qui rÃ©vÃ¨le vraisemblablement une grosse activitÃ© Ã©conomique, comme un exchange par exemple. La dÃ©pense groupÃ©e permet Ã  ces entitÃ©s dâ€™Ã©conomiser des frais en rÃ©unissant leurs dÃ©penses dans une seule transaction.

Nous pouvons en dÃ©duire que lâ€™UTXO en entrÃ©e provient dâ€™une sociÃ©tÃ© avec une grosse activitÃ© Ã©conomique et que les UTXOs en sorties vont se disperser. Certains appartiendront Ã  des clients de la sociÃ©tÃ©. Dâ€™autres iront peut-Ãªtre vers des sociÃ©tÃ©s partenaires. Enfin, il y aura certainement un change qui reviendra Ã  la sociÃ©tÃ© Ã©mettrice.

Par exemple, voici une transaction Bitcoin qui adopte le pattern de la dÃ©pense groupÃ©e :

8a7288758b6e5d550897beedd13c70bcbaba8709af01a7dbcc1f574b89176b43

### **Les transactions propres Ã  un protocole**

Parmi les patterns de transactions, nous pouvons Ã©galement identifier des modÃ¨les qui rÃ©vÃ¨lent lâ€™utilisation dâ€™un protocole spÃ©cifique. Par exemple, [les coinjoins](https://www.pandul.fr/post/comprendre-et-utiliser-le-coinjoin-sur-bitcoin) Whirlpool vont avoir une structure facilement identifiable qui permet de les diffÃ©rencier d'autres transactions classiques.

L'analyse de ce pattern suggÃ¨re que nous sommes vraisemblablement en prÃ©sence d'une transaction collaborative. Il est aussi possible d'y observer un coinjoin. Si cette derniÃ¨re hypothÃ¨se se rÃ©vÃ¨le exacte, alors le nombre de sorties pourrait nous fournir une estimation approximative du nombre de participants.

Par exemple, voici une transaction Bitcoin qui adopte le pattern de la transaction collaborative de type coinjoin :

00601af905bede31086d9b1b79ee8399bd60c97e9c5bba197bdebeee028b9bea

Il existe de nombreux autres protocoles qui disposent de leurs propres structures spÃ©cifiques. Ainsi, nous pourrions distinguer des transactions de type Wabisabi ou bien des [transactions Stamps](https://www.pandul.fr/post/tout-savoir-sur-le-fonctionnement-d-utreexo) par exemple.

## **Les heuristiques internes Ã  la transaction**

Une heuristique interne est une caractÃ©ristique spÃ©cifique que l'on identifie au sein mÃªme d'une transaction, sans nÃ©cessiter l'examen de son environnement, et qui nous permet de rÃ©aliser des dÃ©ductions. Contrairement aux patterns qui se focalisent sur la structure globale de la transaction, les heuristiques internes se fondent sur l'ensemble des donnÃ©es extractibles. Cela inclut :

* Les montants des diffÃ©rents UTXOs en entrÃ©e comme en sortie ;
* Tout ce qui touche aux scripts : les adresses de rÃ©ception, les versionnages, les locktimesâ€¦

GÃ©nÃ©ralement, ce type dâ€™heuristique va nous permettre dâ€™identifier le change dans une transaction spÃ©cifique. Ce faisant, nous pourrons ensuite perpÃ©tuer le traÃ§age dâ€™une entitÃ© sur plusieurs transactions diffÃ©rentes.

Une nouvelle fois, je vous rappelle que ces heuristiques ne sont pas dâ€™une prÃ©cision absolue. Prises individuellement, elles nous permettent uniquement dâ€™identifier des scÃ©narios vraisemblables. Câ€™est lâ€™accumulation de plusieurs heuristiques qui contribue Ã  attÃ©nuer l'incertitude, sans toutefois jamais parvenir Ã  l'Ã©liminer totalement.

### **Les similitudes internes**

Cette heuristique regroupe lâ€™Ã©tude des similitudes entre les entrÃ©es et les sorties dâ€™une mÃªme transaction. Si lâ€™on observe une mÃªme caractÃ©ristique sur les entrÃ©es et sur une seule des sorties de la transaction, alors il est vraisemblable que cette sortie constitue le change.

La caractÃ©ristique la plus flagrante est la rÃ©utilisation dâ€™une adresse de rÃ©ception dans une mÃªme transaction.

Cette heuristique laisse peu de place au doute. Ã€ moins quâ€™il se soit fait pirater sa clÃ© privÃ©e, une mÃªme adresse de rÃ©ception rÃ©vÃ¨le forcÃ©ment lâ€™activitÃ© dâ€™un unique utilisateur. Lâ€™interprÃ©tation qui en dÃ©coule est que le change de la transaction est la sortie avec la mÃªme adresse que lâ€™entrÃ©e. On pourra ainsi continuer de tracer lâ€™individu Ã  partir de ce change.

Par exemple, voici une transaction sur laquelle on peut vraisemblablement appliquer cette heuristique :

54364146665bfc453a55eae4bfb8fdf7c721d02cb96aadc480c8b16bdeb8d6d0

Ces similitudes entre les entrÃ©es et les sorties ne sâ€™arrÃªtent pas Ã  la rÃ©utilisation dâ€™adresse. Toute ressemblance dans lâ€™utilisation des scripts peut permettre lâ€™application dâ€™une heuristique. Par exemple, on va parfois pouvoir observer le mÃªme versionnage entre lâ€™entrÃ©e et une des sorties de la transaction.

Sur ce schÃ©ma, on peut voir que lâ€™input (entrÃ©e) nÂ° 0 dÃ©bloque un script P2WPKH* (SegWit V0 commenÃ§ant par Â« bc1q Â»). Lâ€™output (sortie) nÂ° 0 utilise le mÃªme type de script. En revanche, lâ€™output nÂ° 1 utilise un script P2TR* (SegWit V1 commenÃ§ant par Â« bc1p Â»). Lâ€™interprÃ©tation de cette caractÃ©ristique est quâ€™il est vraisemblable que lâ€™adresse avec le mÃªme versionnage que lâ€™entrÃ©e soit lâ€™adresse de change. Elle appartiendrait donc toujours au mÃªme utilisateur.

Voici une transaction sur laquelle on peut vraisemblablement appliquer cette heuristique :

db07516288771ce5d0a06b275962ec4af1b74500739f168e5800cbcb0e9dd578

Sur cette derniÃ¨re, on peut voir que lâ€™input nÂ° 0 et lâ€™output nÂ° 1 utilisent des scripts P2WPKH* (SegWit V0), alors que lâ€™output nÂ° 0 utilise un script diffÃ©rent de type P2PKH* (Legacy).

### **Les paiements par nombres ronds**

Une autre heuristique interne qui peut nous permettre dâ€™identifier le change est celle du nombre rond. De maniÃ¨re gÃ©nÃ©rale, lorsque lâ€™on se retrouve face Ã  un pattern de paiement simple (1 entrÃ©e et 2 sorties), si une des sorties dÃ©pense un montant rond, alors celle-ci reprÃ©sente le paiement.

Par Ã©limination, si une sortie reprÃ©sente le paiement, lâ€™autre reprÃ©sente le change. On peut donc interprÃ©ter quâ€™il est vraisemblable que lâ€™utilisateur en entrÃ©e soit toujours en possession de la sortie identifiÃ©e comme Ã©tant le change.

Il convient de souligner que cette heuristique n'est pas toujours applicable, puisque la majoritÃ© des paiements s'effectuent encore en unitÃ©s de compte fiduciaires. En effet, lorsqu'un commerÃ§ant en France accepte le bitcoin, en gÃ©nÃ©ral, il nâ€™affiche pas des prix stables en sats. Il optera plutÃ´t pour une conversion entre le prix en euros et le montant en bitcoins Ã  rÃ©gler. Il ne devrait donc pas y avoir de nombre rond en sortie de la transaction. NÃ©anmoins, un analyste pourrait tenter de rÃ©aliser cette conversion en tenant compte du taux de change en vigueur lorsque la transaction a Ã©tÃ© diffusÃ©e sur le rÃ©seau.

Si un jour, le bitcoin devient lâ€™unitÃ© de compte prÃ©fÃ©rÃ©e dans nos Ã©changes, cette heuristique pourrait devenir encore plus utile pour les analyses.

Par exemple, voici une transaction sur laquelle on peut vraisemblablement appliquer cette heuristique :

2bcb42fab7fba17ac1b176060e7d7d7730a7b807d470815f5034d52e96d2828a

### **La grande sortie**

Lorsque lâ€™on repÃ¨re un Ã©cart suffisamment large entre 2 sorties de transactions sur un modÃ¨le de paiement simple, on peut estimer que la sortie la plus grande est vraisemblablement le change.

Cette heuristique du plus gros output (sortie) est sÃ»rement la plus imprÃ©cise de toutes. Si on lâ€™identifie seule, elle est assez faible. Toutefois, cette caractÃ©ristique peut Ãªtre additionnÃ©e avec dâ€™autres heuristiques afin de rÃ©duire lâ€™incertitude de notre interprÃ©tation.

Par exemple, si nous examinons une transaction prÃ©sentant une sortie avec un montant rond et une autre sortie avec un montant plus important, l'application conjointe de l'heuristique des paiements ronds et de celle concernant la plus grande sortie nous permet de rÃ©duire notre niveau d'incertitude.

Par exemple, voici une transaction sur laquelle on peut vraisemblablement appliquer cette heuristique :

b79d8f8e4756d34bbb26c659ab88314c220834c7a8b781c047a3916b56d14dcf

## **Les heuristiques externes Ã  la transaction**

Lâ€™Ã©tude des heuristiques externes, câ€™est lâ€™analyse des similitudes, des patterns et des caractÃ©ristiques de certains Ã©lÃ©ments qui ne sont pas propres Ã  la transaction en elle-mÃªme. Autrement dit, si prÃ©cÃ©demment, nous nous limitions Ã  l'exploitation d'Ã©lÃ©ments intrinsÃ¨ques Ã  la transaction avec les heuristiques internes, nous Ã©largissons dÃ©sormais notre champ dâ€™analyse Ã  l'environnement de la transaction grÃ¢ce aux heuristiques externes.

### **La rÃ©utilisation dâ€™adresse**

Câ€™est une des heuristiques les plus connues des bitcoiners. La rÃ©utilisation dâ€™adresse permet dâ€™Ã©tablir un lien entre diffÃ©rentes transactions et diffÃ©rents UTXOs. Elle sâ€™observe lorsquâ€™une adresse de rÃ©ception Bitcoin est utilisÃ©e plusieurs fois.

Lâ€™interprÃ©tation de la rÃ©utilisation dâ€™une adresse est que tous les UTXOs bloquÃ©s sur cette adresse appartiennent (ou ont appartenu) Ã  une mÃªme entitÃ©. Cette heuristique laisse peu de place Ã  l'incertitude. Lorsque l'on parvient Ã  l'identifier, l'interprÃ©tation qui en dÃ©coule a de fortes chances de correspondre Ã  la rÃ©alitÃ©.

Comme expliquÃ© en introduction, cette heuristique fut dÃ©couverte par Satoshi Nakamoto lui-mÃªme. Dans le White Paper (livre blanc), il Ã©voque justement une solution pour que les utilisateurs Ã©vitent de la produire, qui est tout simplement dâ€™utiliser une adresse vierge pour chaque nouvelle transaction :

> Â« *En guise de pare-feu additionnel, une nouvelle paire de clÃ©s pourrait Ãªtre utilisÃ©e pour chaque transaction afin de les garder non liÃ©es Ã  un propriÃ©taire commun.* Â»

Par exemple, voici une adresse rÃ©utilisÃ©e sur plusieurs transactions :

bc1qqtmeu0eyvem9a85l3sghuhral8tk0ar7m4a0a0

### **La similitude des scripts et les empreintes de portefeuilles**

Au-delÃ  de la rÃ©utilisation dâ€™adresse, il existe de nombreuses autres heuristiques qui permettent de rattacher des actions Ã  un mÃªme portefeuille ou Ã  un cluster dâ€™adresses.

Tout dâ€™abord, un analyste peut sâ€™aider des similitudes dans lâ€™utilisation des scripts. Par exemple, certains scripts minoritaires comme du multisig peuvent Ãªtre plus facilement repÃ©rables que des scripts SegWit V0. Au plus le groupe dans lequel nous nous cachons est grand, au plus il est difficile de nous repÃ©rer. Câ€™est notamment pour cette raison que sur le protocole de [Coinjoin Whirlpool](https://www.pandul.fr/post/comprendre-et-utiliser-le-coinjoin-sur-bitcoin), lâ€™ensemble des participants utilisent exactement le mÃªme type de script.

De maniÃ¨re plus globale, un analyste peut Ã©galement se focaliser sur les empreintes caractÃ©ristiques d'un portefeuille. Il s'agit de procÃ©dÃ©s spÃ©cifiques Ã  une utilisation que l'on peut chercher Ã  identifier dans le but de les exploiter comme heuristiques de traÃ§age. Autrement dit, si lâ€™on observe une accumulation des mÃªmes caractÃ©ristiques internes sur des transactions attribuÃ©es Ã  lâ€™entitÃ© tracÃ©e, on peut tenter dâ€™identifier ces mÃªmes caractÃ©ristiques sur dâ€™autres transactions.

Par exemple, on va pouvoir identifier que lâ€™utilisateur tracÃ© envoie systÃ©matiquement son change sur des adresses P2TR* (bc1pâ€¦). Si ce processus se rÃ©pÃ¨te, on pourra lâ€™utiliser comme une heuristique pour la suite de notre analyse. On peut aussi utiliser dâ€™autres empreintes, comme lâ€™ordre des UTXOs, la place du change dans les sorties, la signalisation de RBF (Replace-by-Fee), ou encore, le numÃ©ro de version et le locktime.

Comme le prÃ©cise [@LaurentMT](https://twitter.com/LaurentMT) dans le [Space Kek #19](https://podcasters.spotify.com/pod/show/decouvrebitcoin/episodes/SpaceKek-19---Analyse-de-chane--anonsets-et-entropie-e1vfuji), l'utilitÃ© des empreintes de portefeuille dans l'analyse de chaÃ®ne s'accroÃ®t de maniÃ¨re significative avec le temps. En effet, le nombre croissant de types de scripts et le dÃ©ploiement de plus en plus progressif de ces nouvelles fonctionnalitÃ©s par les logiciels de portefeuille accentuent les diffÃ©rences. Il arrive mÃªme que l'on puisse identifier avec exactitude le logiciel employÃ© par l'entitÃ© tracÃ©e. Il faut donc comprendre que lâ€™Ã©tude de lâ€™empreinte d'un portefeuille s'avÃ¨re particuliÃ¨rement pertinente pour les transactions rÃ©centes, davantage que pour celles initiÃ©es au dÃ©but des annÃ©es 2010.

Pour rÃ©sumer, une empreinte peut Ãªtre nâ€™importe quelle pratique spÃ©cifique, rÃ©alisÃ©e automatiquement par le portefeuille ou manuellement par lâ€™utilisateur, que lâ€™on pourra retrouver sur dâ€™autres transactions pour nous aider dans notre analyse.

### **La CIOH**

La CIOH, pour Â« Common Input Ownership Heuristic Â», que l'on pourrait traduire en franÃ§ais par Â« heuristique de propriÃ©tÃ© commune des entrÃ©es Â» ou Â« heuristique de co-dÃ©pense Â», est une heuristique stipulant que lorsqu'une transaction comporte plusieurs entrÃ©es, ces derniÃ¨res Ã©manent vraisemblablement toutes d'une entitÃ© unique. En consÃ©quence, leur propriÃ©tÃ© est commune.

Pour appliquer la CIOH, on va dâ€™abord observer une transaction qui dispose de plusieurs entrÃ©es. Cela peut Ãªtre deux entrÃ©es, comme 30 entrÃ©es. Une fois que cette caractÃ©ristique est repÃ©rÃ©e, on va vÃ©rifier si la transaction ne rentre pas dans un pattern connu. Par exemple, si elle comporte 5 entrÃ©es avec Ã  peu prÃ¨s le mÃªme montant et 5 sorties avec exactement le mÃªme montant, on saura que câ€™est la structure dâ€™un [Coinjoin Whirlpool](https://www.pandul.fr/post/comprendre-et-utiliser-le-coinjoin-sur-bitcoin). On ne pourra donc pas appliquer la CIOH.

En revanche, si la transaction ne rentre dans aucun pattern connu de transaction collaborative, alors on peut interprÃ©ter que toutes les entrÃ©es proviennent vraisemblablement de la mÃªme entitÃ©. Cela peut Ãªtre trÃ¨s utile pour Ã©largir un cluster dÃ©jÃ  connu ou pour perpÃ©tuer un traÃ§age.

La CIOH a Ã©tÃ© dÃ©couverte par Satoshi Nakamoto. Il en parle dans la partie 10 du White Paper (livre blanc) :

> Â« *[...] le lien est inÃ©vitable avec les transactions Ã  plusieurs entrÃ©es, qui rÃ©vÃ¨lent nÃ©cessairement que leurs entrÃ©es Ã©taient dÃ©tenues par un mÃªme propriÃ©taire. Le risque est que si le propriÃ©taire d'une clÃ© est rÃ©vÃ©lÃ©, les liens peuvent rÃ©vÃ©ler d'autres transactions qui ont appartenu au mÃªme propriÃ©taire.* Â»

Il est particuliÃ¨rement fascinant de constater que Satoshi Nakamoto, avant mÃªme le lancement officiel de Bitcoin, avait dÃ©jÃ  identifiÃ© les deux principales vulnÃ©rabilitÃ©s en matiÃ¨re de confidentialitÃ© pour les utilisateurs, Ã  savoir la CIOH et la rÃ©utilisation d'adresse. Une telle clairvoyance est assez remarquable, car ces deux heuristiques demeurent, encore aujourdâ€™hui, les plus utiles dans l'analyse de chaÃ®ne.

### **Les donnÃ©es off-chain**

Ã‰videmment, lâ€™analyse de chaÃ®ne ne se limite pas Ã  des donnÃ©es on-chain. Toute donnÃ©e issue d'une analyse antÃ©rieure ou accessible sur Internet peut Ã©galement Ãªtre utilisÃ©e pour affiner une analyse.

Par exemple, si l'on observe que les transactions tracÃ©es sont systÃ©matiquement diffusÃ©es depuis le mÃªme nÅ“ud Bitcoin et que l'on parvient Ã  identifier son adresse IP, il est possible que l'on puisse repÃ©rer d'autres transactions de la mÃªme entitÃ©.

L'analyste a aussi la possibilitÃ© de sâ€™appuyer sur des analyses prÃ©alablement rendues open-source, ou bien sur ses propres analyses antÃ©rieures. Peut-Ãªtre que lâ€™on va pouvoir trouver une sortie qui pointe vers un cluster dâ€™adresses que lâ€™on avait dÃ©jÃ  identifiÃ©es. Parfois, il est aussi possible de s'appuyer sur des sorties qui pointent vers un exchange, les adresses de ces plateformes Ã©tant gÃ©nÃ©ralement connues.

De la mÃªme maniÃ¨re, on peut rÃ©aliser une analyse par Ã©limination. Par exemple, si lors de l'analyse d'une transaction comportant deux sorties, l'une d'elles se rattache Ã  un cluster d'adresses dÃ©jÃ  connu, mais distinct de l'entitÃ© que l'on trace, alors on peut interprÃ©ter que l'autre sortie reprÃ©sente vraisemblablement le change.

Lâ€™analyse de chaÃ®ne inclut aussi une partie dâ€™OSINT (Open Source Intelligence) un peu plus gÃ©nÃ©raliste avec des recherches sur internet. Câ€™est pour cette raison que lâ€™on dÃ©conseille de publier des adresses de rÃ©ception directement sur les rÃ©seaux sociaux ou sur un site web, que ce soit sous pseudo ou non.

### **Les modÃ¨les temporels**

On y pense moins, mais certains comportements humains sont reconnaissables on-chain. Celui qui est le plus utile dans une Ã©tude, câ€™est votre rythme de sommeil ! Et oui, lorsque vous dormez, Ã  priori, vous ne diffusez pas de transactions Bitcoin. Or, vous dormez gÃ©nÃ©ralement Ã  peu prÃ¨s aux mÃªmes horaires. Il est donc courant dâ€™utiliser des analyses temporelles dans lâ€™analyse on-chain. Il s'agit tout simplement du recensement des heures auxquelles les transactions d'une entitÃ© donnÃ©e sont diffusÃ©es au rÃ©seau Bitcoin. Lâ€™analyse de ces patterns temporels nous permet de dÃ©duire de nombreuses informations.

Tout dâ€™abord, une analyse temporelle permet parfois dâ€™identifier la nature de lâ€™entitÃ© tracÃ©e. Si lâ€™on observe que les transactions sont diffusÃ©es de maniÃ¨re constante sur 24 heures, alors cela va trahir une forte activitÃ© Ã©conomique. Lâ€™entitÃ© derriÃ¨re ces transactions est vraisemblablement une entreprise, potentiellement internationale et peut-Ãªtre avec des procÃ©dures automatisÃ©es en interne.

Par exemple, jâ€™avais reconnu ce pattern il y a quelques semaines en analysant la transaction qui avait par erreur allouÃ© 19 bitcoins de frais. Une simple analyse temporelle mâ€™avait permis d'Ã©mettre lâ€™hypothÃ¨se que lâ€™on avait affaire Ã  un service automatisÃ©, et donc vraisemblablement Ã  une grosse entitÃ© de type exchange.

Effectivement, quelques jours plus tard, on a dÃ©couvert que les fonds appartenaient Ã  PayPal, via lâ€™exchange Paxos.

Au contraire, si lâ€™on voit que le pattern temporel est plutÃ´t rÃ©parti sur 16 heures bien spÃ©cifiques, alors on peut estimer que lâ€™on a affaire Ã  un utilisateur individuel, ou peut-Ãªtre Ã  une entreprise locale en fonction des volumes Ã©changÃ©s.

Au-delÃ  de la nature de lâ€™entitÃ© observÃ©e, le pattern temporel peut Ã©galement nous indiquer approximativement la localisation de lâ€™utilisateur. On pourra ainsi rapprocher dâ€™autres transactions, et utiliser lâ€™horodatage de celles-ci comme une heuristique supplÃ©mentaire pouvant sâ€™ajouter Ã  notre analyse.

Par exemple, sur l'adresse rÃ©utilisÃ©e plusieurs fois dont je vous ai prÃ©alablement parlÃ©, on peut observer que les transactions, qu'elles soient entrantes ou sortantes, se concentrent sur un intervalle de 13 heures.

Cet intervalle correspond vraisemblablement Ã  lâ€™Europe, Ã  lâ€™Afrique ou au Moyen-Orient. On peut donc interprÃ©ter que lâ€™utilisateur derriÃ¨re ces transactions habite par lÃ .

### **Lâ€™analyse des volumes**

Une autre heuristique externe qui peut Ãªtre utilisÃ©e est lâ€™analyse des volumes Ã©changÃ©s. En fonction des montants prÃ©sents dans chaque transaction attribuÃ©e Ã  une entitÃ©, on va pouvoir utiliser cette information comme une heuristique supplÃ©mentaire pour le reste de lâ€™analyse.

Cette heuristique est Ã©videmment assez faible, mais elle peut permettre de rÃ©duire lâ€™incertitude en lâ€™additionnant Ã  dâ€™autres heuristiques.

## **Comment se protÃ©ger face Ã  lâ€™analyse de chaÃ®ne ?**

En tant qu'utilisateur de Bitcoin, vous avez le droit de protÃ©ger votre vie privÃ©e. Cela dÃ©coule de vos droits naturels de possÃ©der et de disposer de vous-mÃªme, qui sont inhÃ©rents Ã  chaque individu, indÃ©pendamment de toute contrainte lÃ©gislative.

Ce droit naturel de protÃ©ger sa vie privÃ©e est d'ailleurs dÃ©tournÃ© dans un droit-crÃ©ance, consacrÃ© par l'article 12 de la DÃ©claration universelle des droits de l'homme, stipulant que Â« *Nul ne sera l'objet d'immixtions arbitraires dans sa vie privÃ©e, sa famille, son domicile ou sa correspondance, ni d'atteintes Ã  son honneur et Ã  sa rÃ©putation. Toute personne a droit Ã  la protection de la loi contre de telles immixtions ou de telles atteintes.* Â».

Or, le cÅ“ur de mÃ©tier des entreprises spÃ©cialisÃ©es en analyse de chaÃ®ne consiste prÃ©cisÃ©ment Ã  s'ingÃ©rer dans votre sphÃ¨re privÃ©e, compromettant ainsi la confidentialitÃ© de votre correspondance. Alors qu'on pourrait espÃ©rer que, conformÃ©ment au droit-crÃ©ance susmentionnÃ©, les Ã‰tats dÃ©fendent avec vigueur notre vie privÃ©e, non seulement ils nÃ©gligent de le faire, mais ils alimentent mÃªme substantiellement le financement de ces entreprises d'analyse. Il serait Ã©galement vain d'espÃ©rer lâ€™appui de la part des associations du secteur, qui semblent disposÃ©es Ã  toutes les concessions face au lÃ©gislateur.

De facto, ce droit-crÃ©ance Ã  la vie privÃ©e sur Bitcoin nâ€™existe pas. Il vous revient donc Ã  vous, utilisateur, de faire valoir votre droit naturel et de protÃ©ger la confidentialitÃ© de votre correspondance. Cela implique l'adoption de diverses techniques et pratiques d'utilisation, qui vous permettront dâ€™empÃªcher ou de tromper les heuristiques utilisÃ©es pour lâ€™analyse de chaÃ®ne.

### **Ã‰viter de rentrer dans les heuristiques**

Tout dâ€™abord, avant dâ€™envisager des mÃ©thodes plus radicales, il convient de limiter au maximum notre exposition aux heuristiques utilisÃ©es pour lâ€™analyse de chaÃ®ne. Nous lâ€™avons dit prÃ©cÃ©demment, les deux heuristiques les plus puissantes sont la rÃ©utilisation dâ€™adresse et la CIOH.

Le principe de base pour garantir votre vie privÃ©e sur Bitcoin rÃ©side dans l'utilisation d'une nouvelle adresse vierge pour chaque transaction entrante en direction de votre portefeuille. La rÃ©utilisation d'adresse constitue vÃ©ritablement la menace principale Ã  la confidentialitÃ© sur Bitcoin.

Pour un utilisateur individuel, gÃ©nÃ©rer une nouvelle adresse pour chaque paiement entrant s'avÃ¨re Ãªtre trÃ¨s simple. Les bons portefeuilles modernes le font automatiquement dÃ¨s lors que vous cliquez sur Â« Recevoir Â». Alors, si vous accordez ne serait-ce qu'une infime importance Ã  la confidentialitÃ© de vos transactions, l'utilisation d'adresses vierges reprÃ©sente le strict minimum. Si jamais vous avez besoin dâ€™un point de contact statique sur internet, au lieu de mettre une adresse de rÃ©ception, vous pouvez utiliser des solutions [comme PayNym qui implÃ©mentent le BIP47](https://www.pandul.fr/post/bip47-paynym-et-code-de-paiement-r%C3%A9utilisable).

Ensuite, si vous souhaitez agir face Ã  la CIOH, Ã©vitez de fusionner des UTXOs en entrÃ©e de transaction. Au minimum, si vous devez vraiment fusionner, privilÃ©giez des UTXOs qui ont la mÃªme source. Cette recommandation implique dâ€™avoir une bonne gestion de ses UTXOs. Lors de lâ€™achat de vos bitcoins, privilÃ©giez des transferts impliquant de gros montants pour maximiser le nombre de paiements que vous pourrez effectuer sans avoir Ã  fusionner. Je vous conseille Ã©galement d'Ã©tiqueter vos UTXOs dans votre logiciel afin d'en identifier la provenance et d'Ã©viter la fusion de sources distinctes.

Plus largement, pour toutes les autres heuristiques, il faut les connaÃ®tre pour essayer de ne pas tomber dedans :

* Nâ€™utilisez pas de scripts minoritaires. PrÃ©fÃ©rez du SegWit V0 ou Ã©ventuellement du SegWit V1 ;
* Ne faites pas des paiements par nombre rond. Par exemple, si vous devez envoyer 100k sats Ã  un ami, envoyez-lui 114 486 sats. Il vous paiera Ã  boire en Ã©change ;
* Essayez de ne pas toujours avoir un change qui soit bien plus gros que la sortie de paiement ;
* Ne publiez pas vos adresses de rÃ©ception sur les rÃ©seaux sociaux ;
* Utilisez votre propre nÅ“ud sous Tor pour diffuser vos transactions ;
* Essayez de ne pas toujours diffuser vos transactions Bitcoin Ã  la mÃªme heureâ€¦

### **Utiliser des outils de confidentialitÃ©**

Vous pouvez Ã©galement vous tourner vers des mÃ©thodes qui permettent de rendre ambigÃ¼e votre utilisation de Bitcoin afin dâ€™empÃªcher ou de tromper lâ€™analyse de chaÃ®ne.

La technique la plus populaire est sÃ»rement le Coinjoin, une structure de transaction collaborative qui mobilise plusieurs UTXOs de mÃªmes montants. Lâ€™objectif ici est de rompre les liens dÃ©terministes, empÃªchant ainsi les analyses du prÃ©sent vers le passÃ© et du passÃ© vers le prÃ©sent. Le Coinjoin permet de produire du dÃ©ni plausible en cachant vos piÃ¨ces au sein dâ€™un grand groupe de piÃ¨ces indiffÃ©renciables. Si vous souhaitez en savoir plus sur le Coinjoin, tant sur le plan technique que pratique, je vous suggÃ¨re de lire cet article complet : [Comprendre et utiliser le CoinJoin sur Bitcoin.](https://www.pandul.fr/post/comprendre-et-utiliser-le-coinjoin-sur-bitcoin)

Le CoinJoin est un excellent outil pour produire du dÃ©ni plausible sur des piÃ¨ces, mais il nâ€™est pas optimisÃ© pour tous les besoins de lâ€™utilisateur en termes de confidentialitÃ©. Typiquement, le CoinJoin nâ€™a pas Ã©tÃ© pensÃ© pour devenir un outil de paiement. Il est trÃ¨s rigide sur les montants Ã©changÃ©s afin de perfectionner la production de dÃ©ni plausible. Puisque lâ€™on ne peut pas choisir librement le montant des sorties de transaction, alors on ne peut pas utiliser le CoinJoin pour payer en bitcoins.

Par exemple, imaginons que je souhaite payer ma baguette en bitcoins tout en optimisant ma confidentialitÃ©. Ã‰tant donnÃ© l'impossibilitÃ© de sÃ©lectionner le montant de l'UTXO rÃ©sultant du CoinJoin, je me trouverais dans l'incapacitÃ© d'ajuster le montant de ma dÃ©pense au tarif fixÃ© par le boulanger. De ce fait, le CoinJoin se rÃ©vÃ¨le inadÃ©quat pour des transactions de paiement.

Dâ€™autres outils ont ainsi Ã©tÃ© imaginÃ©s pour rÃ©pondre Ã  des besoins de confidentialitÃ© dans des cas dâ€™utilisation plus spÃ©cifiques. Par exemple, nous avons le PayJoin, une sorte de mini-CoinJoin, impliquant uniquement deux participants et reposant sur une structure qui permet un paiement.

La particularitÃ© du PayJoin rÃ©side dans sa capacitÃ© Ã  produire une transaction qui semble ordinaire, alors qu'elle constitue en rÃ©alitÃ© un mini-CoinJoin entre deux utilisateurs. Dans cette structure, le destinataire de la transaction intervient parmi les entrÃ©es aux cÃ´tÃ©s de l'expÃ©diteur rÃ©el. Ainsi, le destinataire insÃ¨re un paiement vers lui-mÃªme au sein de la transaction qui permet le paiement rÃ©el.

Par exemple, si vous achetez une baguette Ã  votre boulanger pour 6 000 sats Ã  partir dâ€™un UTXO de 10 000 sats, et que vous souhaitez faire un PayJoin, votre boulanger va ajouter en entrÃ©e de votre transaction originelle un UTXO de 15 000 sats qui lui appartient, quâ€™il va rÃ©cupÃ©rer en intÃ©gralitÃ© en sortie, afin de tromper les heuristiques :

Les frais de transaction sont nÃ©gligÃ©s afin de faciliter la comprÃ©hension du schÃ©ma.

Les objectifs du PayJoin sont doubles. Tout d'abord, il vise Ã  tromper un observateur extÃ©rieur en produisant un leurre grÃ¢ce Ã  la CIOH. En effet, lorsqu'un analyste observe cette transaction, il va penser quâ€™il peut appliquer la CIOH, et ainsi prÃ©sumer une propriÃ©tÃ© commune des diffÃ©rentes entrÃ©es. En rÃ©alitÃ©, cette supposition est erronÃ©e, car une entrÃ©e appartient Ã  l'Ã©metteur, tandis que l'autre est la propriÃ©tÃ© du destinataire. Le PayJoin a donc pour effet de corrompre l'analyse de chaÃ®ne, en orientant l'analyste sur un chemin qui se rÃ©vÃ¨le Ãªtre le mauvais.

Le second objectif du PayJoin est de tromper l'analyste sur le montant rÃ©el de la transaction, grÃ¢ce Ã  la structure spÃ©cifique de ses sorties. Le PayJoin s'inscrit ainsi dans le champ de la stÃ©ganographie. Il permet de dissimuler le montant rÃ©el de la transaction au sein d'une transaction trompeuse.

Effectivement, si lâ€™on reprend notre exemple du PayJoin pour acheter une baguette, un observateur extÃ©rieur va penser que lâ€™on a affaire Ã  un paiement de 4 000 sats ou de 21 000 sats. En rÃ©alitÃ©, le paiement pour la baguette est de 6 000 sats : 21 000 - 15 000 = 6 000. La valeur rÃ©elle du paiement est donc cachÃ©e au sein dâ€™un faux paiement qui agit comme un leurre pour lâ€™analyse de chaÃ®ne.

Au-delÃ  du PayJoin et du CoinJoin, il existe de nombreuses autres structures de transactions Bitcoin qui permettent soit de bloquer lâ€™analyse de chaÃ®ne, soit de la tromper. Parmi celles-ci, je pourrais citer les transactions [Stonewall](https://www.pandul.fr/post/comprendre-et-utiliser-le-coinjoin-sur-bitcoin#viewer-b7hbd)et [StonewallX2](https://www.pandul.fr/post/comprendre-et-utiliser-le-coinjoin-sur-bitcoin#viewer-b7hbd), qui permettent soit de faire un mini Coinjoin flexible, soit dâ€™imiter un mini Coinjoin flexible. Il y a Ã©galement les transactions [Ricochet](https://www.pandul.fr/post/comprendre-et-utiliser-le-coinjoin-sur-bitcoin#viewer-b7hbd) qui permettent de simuler un changement de propriÃ©taire des bitcoins en rÃ©alisant une multitude de faux transferts vers soi-mÃªme.

Tous ces outils sont disponibles sur les portefeuilles Samourai Wallet sur mobile, et Sparrow Wallet sur PC. Si vous souhaitez en savoir plus sur ces structures de transaction spÃ©cifiques, je vous conseille de lire la partie Â« Les outils de dÃ©pense Â» dans cet article : [Comprendre et utiliser le CoinJoin sur Bitcoin.](https://www.pandul.fr/post/comprendre-et-utiliser-le-coinjoin-sur-bitcoin)

## **Conclusion**

Lâ€™analyse de chaÃ®ne est une pratique qui consiste Ã  essayer de tracer les flux de bitcoins on-chain. Pour ce faire, les analystes cherchent des patterns et des caractÃ©ristiques afin de conclure des hypothÃ¨ses et des interprÃ©tations plus ou moins vraisemblables.

L'exactitude de ces heuristiques varie : certaines procurent un degrÃ© de certitude plus Ã©levÃ© que d'autres, mais aucune ne saurait prÃ©tendre Ã  l'infaillibilitÃ©. Lâ€™accumulation de plusieurs heuristiques convergentes peut toutefois attÃ©nuer ce doute inhÃ©rent, bien qu'il demeure impossible de l'annihiler.

Nous pouvons regrouper ces mÃ©thodes en trois grandes catÃ©gories distinctes :

* Les patterns, axÃ©s sur la structure globale de chaque transaction ;
* Les heuristiques internes, qui permettent l'examen exhaustif de tous les dÃ©tails d'une transaction, sans toutefois s'Ã©tendre Ã  son contexte ;
* Les heuristiques externes, qui englobent l'analyse de la transaction dans son environnement, ainsi que toute donnÃ©e externe susceptible d'apporter un Ã©clairage.

En tant qu'utilisateur de Bitcoin, il est indispensable de s'approprier les principes fondamentaux de l'analyse de chaÃ®ne pour Ãªtre en mesure de la contrer efficacement, et ainsi de protÃ©ger sa vie privÃ©e.

### Miniglossaire technique :

**P2PKH**: sigle pour *Pay to Public Key Hash* (en franÃ§ais Â« payer au hachage dâ€™une clÃ© publique Â»). Câ€™est un modÃ¨le de script standard utilisÃ© pour Ã©tablir des conditions de dÃ©penses sur un UTXO. Il permet de bloquer des bitcoins sur un hachage dâ€™une clÃ© publique, câ€™est-Ã -dire sur une adresse de rÃ©ception. Ce script est associÃ© au standard Legacy, et a Ã©tÃ© introduit dÃ¨s les premiÃ¨res versions de Bitcoin par Satoshi Nakamoto. Ã€ la diffÃ©rence du P2PK, oÃ¹ la clÃ© publique est explicitement incluse dans le script, le P2PKH utilise une empreinte cryptographique de la clÃ© publique, avec quelques mÃ©tadonnÃ©es, Ã©galement nommÃ©e Â« adresse de rÃ©ception Â». Ce script inclut le hachage RIPEMD160 du SHA256 de la clÃ© publique et stipule que, pour accÃ©der aux fonds, le destinataire doit fournir une clÃ© publique correspondant Ã  ce hachage, ainsi qu'une signature numÃ©rique valide gÃ©nÃ©rÃ©e Ã  partir de la clÃ© privÃ©e associÃ©e. Les adresses P2PKH sont encodÃ©es en utilisant le format Base58Check, qui leur confÃ¨re une rÃ©sistance face aux erreurs typographiques grÃ¢ce Ã  l'utilisation d'une somme de contrÃ´le. Ces adresses dÃ©butent systÃ©matiquement par le chiffre 1.

**P2TR** : sigle pour *Pay to Taproot* (en franÃ§ais Â« payer Ã  la racine Â»). Câ€™est un modÃ¨le de script standard utilisÃ© pour Ã©tablir des conditions de dÃ©penses sur un UTXO. P2TR a Ã©tÃ© introduit avec l'implÃ©mentation de Taproot en novembre 2021. Il utilise le protocole de Schnorr pour agrÃ©ger des clÃ©s cryptographiques, ainsi que des arbres de Merkle pour des scripts alternatifs, connus sous le nom de MAST (Merkelized Alternative Script Tree). Contrairement aux transactions traditionnelles oÃ¹ les conditions de dÃ©pense sont exposÃ©es publiquement (parfois Ã  la rÃ©ception, parfois Ã  la dÃ©pense), P2TR permet de masquer des scripts complexes derriÃ¨re une seule clÃ© publique apparente. Techniquement, un script P2TR verrouille des bitcoins sur une clÃ© publique Schnorr unique, dÃ©nommÃ©e *K*. Cependant, cette clÃ© *K* est en rÃ©alitÃ© un agrÃ©gat d'une clÃ© publique *P* et d'une clÃ© publique *M*, cette derniÃ¨re Ã©tant calculÃ©e Ã  partir de la racine de Merkle d'une liste de ScriptPubKeys. L'agrÃ©gation de clÃ©s est rÃ©alisÃ©e Ã  l'aide du protocole de signature de Schnorr. Les bitcoins verrouillÃ©s avec un script P2TR peuvent Ãªtre dÃ©pensÃ©s de deux maniÃ¨res distinctes : soit en publiant une signature pour la clÃ© publique *P*, soit en satisfaisant l'un des scripts contenus dans l'arbre de Merkle. La premiÃ¨re option est appelÃ©e Â« key path Â» (chemin de clÃ©) et la seconde Â« script path Â» (chemin de script). Ainsi, P2TR permet aux utilisateurs d'envoyer des bitcoins soit Ã  une clÃ© publique, soit Ã  plusieurs scripts de leur choix. Un autre avantage de ce script est que, bien qu'il y ait de multiples faÃ§ons de dÃ©penser une sortie P2TR, seule celle qui est utilisÃ©e doit Ãªtre rÃ©vÃ©lÃ©e Ã  la dÃ©pense, permettant ainsi aux alternatives inutilisÃ©es de rester privÃ©es. Par exemple, grÃ¢ce Ã  l'agrÃ©gation des clÃ©s Schnorr, la clÃ© publique *P* peut elle-mÃªme Ãªtre une clÃ© agrÃ©gÃ©e, reprÃ©sentant Ã©ventuellement un multisig. P2TR est une sortie SegWit de version 1, ce qui signifie que les signatures pour les entrÃ©es P2TR sont stockÃ©es dans le tÃ©moin d'une transaction, et non dans le ScriptSig. Les adresses P2TR utilisent un encodage Bech32m et commencent par bc1p.

**P2WPKH** : sigle pour *Pay to Witness Public Key Hash* (en franÃ§ais Â« payer au tÃ©moin du hachage de la clÃ© publique Â»). Câ€™est un modÃ¨le de script standard utilisÃ© pour Ã©tablir des conditions de dÃ©penses sur un UTXO. P2WPKH a Ã©tÃ© introduit avec l'implÃ©mentation de SegWit en aoÃ»t 2017. Ce script est similaire Ã  P2PKH (*Pay to Public Key Hash*), en ce sens qu'il verrouille Ã©galement des bitcoins sur la base du hachage d'une clÃ© publique, câ€™est-Ã -dire dâ€™une adresse de rÃ©ception. La diffÃ©rence rÃ©side dans la maniÃ¨re dont les signatures et les scripts sont inclus dans la transaction. Dans le cadre de P2WPKH, les informations du script de signature (ScriptSig) sont dÃ©placÃ©es de la structure traditionnelle de la transaction vers une section distincte appelÃ©e Witness (tÃ©moin). Ce dÃ©placement est une caractÃ©ristique de la mise Ã  jour SegWit (Segragated Witness). Cette technique prÃ©sente l'avantage de rÃ©duire la taille des donnÃ©es de transaction dans le corps principal, tout en conservant les informations de script nÃ©cessaires Ã  la validation dans une section sÃ©parÃ©e. Par consÃ©quent, les transactions P2WPKH sont gÃ©nÃ©ralement moins coÃ»teuses en termes de frais par rapport aux transactions Legacy. Les adresses P2WPKH sont Ã©crites en utilisant l'encodage Bech32, ce qui contribue Ã  une Ã©criture plus concise et moins sujette aux erreurs typographiques grÃ¢ce Ã  la somme de contrÃ´le sous forme de code BCH. Ces adresses commencent toujours par bc1q, ce qui permet de les distinguer facilement des adresses de rÃ©ception Legacy. P2WPKH est une sortie SegWit de version 0.

**Pattern** : En franÃ§ais, on pourrait le traduire par Â« modÃ¨le Â» ou Â« structure Â».

**UTXO** : Sigle de *Unspent Transaction Output*. Un UTXO est une sortie de transaction qui n'a pas encore Ã©tÃ© dÃ©pensÃ©e ou utilisÃ©e comme entrÃ©e pour une nouvelle transaction. Les UTXOs reprÃ©sentent la fraction de bitcoins que possÃ¨de un utilisateur et qui sont actuellement disponibles pour Ãªtre dÃ©pensÃ©s. Chaque UTXO est associÃ© Ã  un script de sortie spÃ©cifique, qui dÃ©finit les conditions nÃ©cessaires pour dÃ©penser les bitcoins. Les transactions dans Bitcoin consomment ces UTXOs en entrÃ©es (inputs) et crÃ©ent de nouveaux UTXOs en sorties (outputs). Le modÃ¨le d'UTXO est fondamental sur Bitcoin, car il permet de vÃ©rifier facilement que les transactions n'essaient pas de dÃ©penser des bitcoins qui n'existent pas ou qui ont dÃ©jÃ  Ã©tÃ© dÃ©pensÃ©s. En gros, un UTXO câ€™est un morceau de Bitcoin.
